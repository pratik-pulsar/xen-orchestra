doctype html
html
  head
    meta(charset = 'utf-8')
    meta(http-equiv = 'X-UA-Compatible' content = 'IE=edge,chrome=1')
    meta(name = 'viewport' content = 'width=device-width, initial-scale=1.0')
    title Xen Orchestra
    meta(name = 'author' content = 'Vates SAS')
    link(rel = 'stylesheet' href = 'index.css')
  body(style = 'display: flex; height: 100vh; background-image: url("assets/background.jpg"); background-repeat: no-repeat; background-attachment: fixed; background-size: cover;')
    div(style = 'margin: auto; display:flex; background-color: rgb(255,255,255,0.5); padding:20px ; border-radius: 10px;' )
      div(style = 'display: flex;')
        img(src = 'assets/iospark-logo.png' style = 'margin: auto; height:80%')
      
      if error
        p.text-danger #{error}
      if otp
        form(action = 'signin-otp' method = 'post')
          fieldset
            .input-group.mb-1
              span.input-group-addon
                i.fa.fa-key.fa-fw
              input.form-control(
                autocomplete = 'off'
                autofocus
                name = 'otp'
                type = 'text'
                placeholder = 'Code'
                required
              )
            div
              button.btn.btn-block.btn-info
                i.fa.fa-sign-in
                |  Sign in
      else
        each label, id in strategies
          div: a(href = 'signin/' + id).btn.btn-block.btn-primary.mb-1 Sign in with #{label}
        form(action = 'signin/local' method = 'post' style='align-self:center')
          div.mb-2(style='display:flex; justify-contents:center; align-items:center;') 
            img(src='/assets/logo.png' alt='login' style='width:75px; height:50px;') 
            h2.text-xs-center.mb-0.pl-2 Xen Orchestra 
          fieldset
            .input-group.mb-1
              span.input-group-addon
                i.xo-icon-user.fa-fw
              input.form-control(
                autofocus
                name = 'username'
                placeholder = 'Username'
                required
                type = 'text'
              )
            .input-group.mb-1
              span.input-group-addon
                i.fa.fa-key.fa-fw
              input.form-control(
                name = 'password'
                type = 'password'
                placeholder = 'Password'
                required
              )
            .checkbox
              label
                input(
                  name = 'remember-me'
                  type = 'checkbox'
                )
                | &nbsp;
                | Remember me
            div
              button.btn.btn-block.btn-info
                i.fa.fa-sign-in
                |  Sign in
    script.
      (function () {
        var d = document
        var h = d.location.hash
        d.querySelectorAll('a').forEach(a => {
            a.href += h
        })
        d.querySelectorAll('form').forEach(form => {
            form.action += h
        })
      })()
